# `cryptography.hpp`

This file defines utilities in `Cryptography` namespace. Most of them are cryptographic primitives.

## `AgentFlag` enumeration

The namespace should be considered as an enumeration type. The `Type` type is an alias of `unsigned`, which holds the enumeration value. The enumeration is *flagged*, i.e., each bit implies the presence of an agent. `Alice`, `Bob` and `Random` occupy the most insignificant, the second most insignificant and the 18-th most insignificant bit, respectively.

## `ExtendedEuclideanImpl_` namespace

Implements extended euclidean algorithm.

### `DefaultDivider<T>` structure template

A functor type that uses `/` and `%` for computing division with remainder. It is semantically equivalent to:

```C++
void DivideWithRemainder(T &q, T &r, T &&y, T const &tmp)
{
    q = y / tmp;
    r = std::move(y) % tmp;
}
```

### `bool EEInv<TUInt, TDivider>(TUInt x, TUInt const &oldY, TUInt &result, TDivider divider)` function template

`TUInt` must be an unsigned integer type, `TDivider` is a functor type, and `x` must be (strictly) less than `oldY`. It is assumed that `divider(TUInt &q, TUInt &r, TUInt &&y, TUInt const &tmp)` computes `y / tmp` and `y % tmp`, and stores them into `q` and `r`, respectively.

The function computes the multiplicative inverse of `x` modulo `oldY` and stores it into `result` if successful. It returns `true` or `false` indicating whether such computation is successful. It is guaranteed that `result` is assigned to if and only if the function returns `true`, in which case `result` will be (strictly) less than `oldY`.

If the `TUInt` is a custom type and allocates memory, it is recommended that the type allow moving.

### `bool EEInv<TUInt>(TUInt x, TUInt const &oldY, TUInt &result)` function template

Uses `DefaultDivider<TUInt>` to call the other template `EEInv`.

The functor type `DefaultDivider<TUInt>` is a good candidate of `TDivider` for primitive types `TUInt`, but the user shall provide a more efficient version when using the function template with custom unsigned integer types.

## `Z<p, TBaseType, TPromotedType>` structure template

Represents the quotient ring of Z modulo the ideal generated by `p`. It is often the case that `p` is a prime number, but such requirement is not necessary to instantiate the template. `TBaseType` is an optional argument that allows you to specify another underlying type, if not `uint32_t`. `TPromotedType` is a type in which computation will not cause overflow and defaults to `uint64_t`.
